_Цель занятия_ – оценить возможности некоторых критериев проверки статистических гипотез по различению близких альтернатив (критериев однородности средних, однородности дисперсий, однородности законов). Проследить, как в зависимости от объемов выборок меняются результаты проверки (__p-value__). По результатам экспериментов оценить, примерно какой объем выборок потребуется, чтобы принять верное решение и отклонить «__несправедливую__» проверяемую гипотезу.

## Этапы исследования

1.  Смоделировать __2__ выборки в соответствии с __нормальным законом__ объемом $n=1000$ одна с параметрами сдвига и масштаба $(0, 1)$, вторая - с параметрами $(0.1, 1)$, то есть _математическое ожидание_ второй отличается на $10\%$ от стандартного отклонения.
	1. Последовательно, меняя объем выборки $n=25,50,100,200,500,1000$ _(в тексте анализируемых выборок менять объём и перегружать выборки)_, проследите, как меняется __достигаемый уровень значимости__ при проверке гипотезы об __однородности средних__ по следующим критериям: __Стьюдента, сравнения средних при неизвестных и неравных дисперсиях, Краскела-Уаллиса, Манна-Уитни-Уилкоксона.__
	2. _Зафиксируйте_ результаты проверок в таблице.
	3. _Оцените_, примерно какой объем выборок потребуется, чтобы принять верное решение и отклонить «__несправедливую__» проверяемую гипотезу при задании вероятности ошибки $1$-_го_ рода $\alpha=0.1, 0.05, 0.01$.
2. Смоделировать $2$ выборки в соответствии с __нормальным законом__ объемом $n=1000$ одна с параметрами $(0, 1)$, вторая с параметрами $(0, 1.1)$, то есть _стандартное отклонение_ второй отличается на $10\%$ больше чем у первой.
	1. Последовательно, меняя объем выборки $n=25,50,100,200,500,1000$ _(в тексте анализируемых выборок менять объём и перегружать выборки),_ проследите, как меняется __достигаемый уровень значимости__ при проверке гипотезы об __однородности дисперсий__ _(характеристик рассеяния)_ по следующим критериям: параметрическим - __Бартлетта, Фишера__, непараметрическим - __Ансари-Бредли__ _(нормированному)_, __Муда__ _(нормированному)_, __Сижеля-Тьюки__ _(нормированному)_.
	2. _Зафиксируйте_ результаты проверок в таблице.
	3. _Оцените_, примерно какой объем выборок потребуется, чтобы принять верное решение и отклонить «__несправедливую__» проверяемую гипотезу при задании вероятности ошибки $1$-_го_ рода $\alpha=0.1, 0.05, 0.01$.
3. Смоделировать __2__ выборки, одну - в соответствии со [стандартным нормальным законом](https://ru.wikipedia.org/wiki/%D0%9D%D0%BE%D1%80%D0%BC%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B5_%D1%80%D0%B0%D1%81%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5#%D0%A1%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D0%BD%D0%BE%D0%B5_%D0%BD%D0%BE%D1%80%D0%BC%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B5_%D1%80%D0%B0%D1%81%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5) объемом $n=10000$, другую  - по __логистическому закону__  с параметрами сдвига и масштаба $(0, 0.551328895)$.
	1. Последовательно, меняя объемы выборок $n=25,50,100,200,500,1000, 5000, 10000$ _(в тексте анализируемых выборок менять объём и перегружать выборки)_, проследите, как меняется __достигаемый уровень значимости__ при проверке гипотезы об __однородности законов__ по критериям __Смирнова__ и __Лемана-Розенблатта__
	2. _Зафиксируйте_ результаты проверок в таблице.
	3. _Оцените_, какой примерно объем выборок потребуется, чтобы принять верное решение и отклонить «__несправедливую__» проверяемую гипотезу при задании вероятности ошибки $1$-_го_ рода $\alpha=0.1, 0.05, 0.01$.
4. __Кратко сформулируйте для себя выводы, вытекающие из Ваших результатов.__

---
## Выполнение пунктов

### Моделирование выборок с разными средними

#### Моделирование первой выборки

 Эмпирическая функция распределения _(см. график 1)_ выборки _model_1_, смоделированная в соответствии $N(\sigma = 1, \mu = 0)$ со  с объёмом $n=1000$
 
![[graf61.jpg]]
<div style="text-align: center;">
<em><u>График 1</u></em> Эмпирическая функция распределения выборки <em><u>model_1</u></em>
</div>

Функция плотности распределения _(см. график 2)_ выборки _model_1_, смоделированная в соответствии $N(\sigma = 1, \mu = 0)$ со  с объёмом $n=1000$

![[img61.jpg]]
<div style="text-align: center;">
<em><u>График 2</u></em> Функция плотности распределения выборки <em><u>model_1</u></em>
</div>
#### Моделирование второй выборки

Эмпирическая функция распределения _(см. график 3)_ выборки _model_2_, смоделированная в соответствии $N(\sigma = 1, \mu = 0.1)$ со  с объёмом $n=1000$

![[graf62.jpg]]
<div style="text-align: center;">
<em><u>График 3</u></em> Эмпирическая функция распределения выборки <em><u>model_2</u></em>
</div>

Функция плотности распределения _(см. график 4)_ выборки _model_2, смоделированная в соответствии $N(\sigma = 1, \mu = 0.1)$ со  с объёмом $n=1000$

![[img62.jpg]]<div style="text-align: center;">
<em><u>График 4</u></em> Функция плотности распределения выборки <em><u>model_2</u></em>
</div>

### Проверка гипотез об однородности средних

Результаты проверки гипотезы об __однородности средних__ по критерию __Стьюдента__ выборок: _model_1_, _model_2_.

|  $n$   | Значение $S$ | Значение $P$ |
| :----: | :----------: | :----------: |
|  $25$  |  $-1.13767$  |   $0.152$    |
|  $50$  | $-0.934651$  |   $0.1626$   |
| $100$  | $-0.815138$  |   $0.132$    |
| $200$  | $-0.586102$  |   $0.118$    |
| $500$  | $-0.328571$  |    $0.07$    |
| $1000$ | $-0.0142123$ |   $0.026$    |
Результаты проверки гипотезы об __однородности средних__ по критерию __при неизвестных и неравных дисперсиях__ выборок: _model_1_, _model_2_.


|  $n$   | Значение $S$ | Значение $P$ |
| :----: | :----------: | :----------: |
|  $25$  |  $-1.13767$  |   $0.152$    |
|  $50$  | $-0.934651$  |   $0.1626$   |
| $100$  | $-0.815138$  |   $0.132$    |
| $200$  | $-0.586102$  |   $0.118$    |
| $500$  | $-0.328571$  |    $0.07$    |
| $1000$ | $-0.0142123$ |   $0.026$    |
Результаты проверки гипотезы об __однородности средних__ по критерию __Краскела-Уаллиса__ выборок: _model_1_, _model_2_.

|  $n$   | Значение $S$ | Значение $P$ |
| :----: | :----------: | :----------: |
|  $25$  |  $1.76649$   |   $0.198$    |
|  $50$  |  $1.80713$   |   $0.181$    |
| $100$  |  $1.72161$   |    $0.19$    |
| $200$  |  $1.67209$   |   $0.195$    |
| $500$  |  $4.64582$   |   $0.031$    |
| $1000$ |  $5.94448$   |   $0.018$    |
Результаты проверки гипотезы об __однородности средних__ по критерию __Манна-Уитни-Уилкоксона__ выборок: _model_1_, _model_2_.

|  $n$   | Значение $S$ | Значение $P$ |
| :----: | :----------: | :----------: |
|  $25$  |   $1.3291$   |   $0.202$    |
|  $50$  |  $1.34429$   |   $0.188$    |
| $100$  |   $1.3121$   |    $0.19$    |
| $200$  |  $1.29309$   |   $0.206$    |
| $500$  |  $2.15542$   |    $0.04$    |
| $1000$ |  $2.43813$   |   $0.016$    |
Таким образом, рассматривая результаты полученные для критериев _Стьюдента_ и _при неизвестных и неравных дисперсиях_ можно заметить одинаковые результаты. Это связано с тем, что при одинаковых дисперсиях выборок, статистики критериев считаются одинаково. Можно увидеть прогнозируемое снижение $p$-_value_ при увеличении $n$. 

Не трудно догадаться, что увеличение числа наблюдений $n$ благоприятно сказывается на вычисление выборочной дисперсии и среднего значения при вычислении статистик у параметрических критериев, поскольку эти значения стремятся к точному. 

Непараметрические критерии сильнее зависят от $n$, чем параметрические критерии. Можно заметить, что при малых значениях $n$ у параметрических критериев достигнутый уровень значимости меньше, чем у непараметрических. Это связано с тем, что при малых значениях $n$, статистики непараметрических критериев плохо сходятся к их распределениям. Также заметно, что в данном случае, при увеличении $n$ значение $p$-_value_ становится меньше, чем у параметрических критериев. 

Можно сделать вывод, что для того чтобы отклонить __"несправедливую"__ гипотезу при ошибки первого рода $\alpha=0.1$, для параметрических и непараметрических критериев потребуется  $200 < n^* \le 500$ наблюдений. При ошибки первого рода $\alpha = 0.05$, для параметрических критериев потребуется $500 < n^* \le 1000$ наблюдений, для непараметрических критериев потребуется $200 < n^* \le 500$ наблюдений. При ошибки первого рода $\alpha = 0.01$, для параметрических и непараметрических критериев потребуется $n^* > 1000$ наблюдений.

### Моделирование выборок c разными дисперсиями

#### Моделирование первой выборки

 Эмпирическая функция распределения _(см. график 5)_ выборки _model_3_, смоделированная в соответствии $N(\sigma = 1, \mu = 0)$ со  с объёмом $n=1000$
 
![[graf63.jpg]]
<div style="text-align: center;">
<em><u>График 5</u></em> Эмпирическая функция распределения выборки <em><u>model_3</u></em>
</div>

Функция плотности распределения _(см. график 6)_ выборки _model_3_, смоделированная в соответствии $N(\sigma = 1, \mu = 0)$ со  с объёмом $n=1000$

![[img63.jpg]]
<div style="text-align: center;">
<em><u>График 6</u></em> Функция плотности распределения выборки <em><u>model_3</u></em>
</div>
#### Моделирование второй выборки

Эмпирическая функция распределения _(см. график 7)_ выборки _model_4, смоделированная в соответствии $N(\sigma = 1.1, \mu = 0)$ со  с объёмом $n=1000$

![[graf64.jpg]]
<div style="text-align: center;">
<em><u>График 7</u></em> Эмпирическая функция распределения выборки <em><u>model_4</u></em>
</div>

Функция плотности распределения _(см. график 8)_ выборки _model_4, смоделированная в соответствии $N(\sigma = 1.1, \mu = 0)$ со  с объёмом $n=1000$

![[img64.jpg]]<div style="text-align: center;">
<em><u>График 8</u></em> Функция плотности распределения выборки <em><u>model_4</u></em>
</div>

### Проверка гипотез об однородности дисперсий

Результаты проверки гипотезы об __однородности дисперсий__ по критерию __Бартлетта__ выборок: _model_3_, _model_4_.


|  $n$   | Значение $S$ | Значение $P$ |
| :----: | :----------: | :----------: |
|  $25$  |  $0.109422$  |   $0.673$    |
|  $50$  |   $2.9842$   |    $0.02$    |
| $100$  |  $1.76645$   |   $0.088$    |
| $200$  |  $5.43276$   |   $0.001$    |
| $500$  |  $1.13031$   |   $0.138$    |
| $1000$ |  $6.86775$   |   $0.001$    |
Результаты проверки гипотезы об __однородности дисперсий__ по критерию __Фишера__ выборок: _model_3_, _model_4_.


|  $n$   | Значение $S$ | Значение $P$ |
| :----: | :----------: | :----------: |
|  $25$  |  $1,14625$   |    $0.71$    |
|  $50$  |  $0.607365$  |   $0.022$    |
| $100$  |  $0.764732$  |   $0.102$    |
| $200$  |  $0.717756$  |     $0$      |
| $500$  |  $0.909143$  |   $0.138$    |
| $1000$ |  $0.847077$  |   $0.002$    |
Результаты проверки гипотезы об __однородности дисперсий__ по критерию __Ансари-Бредли__ выборок: _model_3_, _model_4_.


|  $n$   | Значение $S$ | Значение $P$ |
| :----: | :----------: | :----------: |
|  $25$  | $-0.077658$  |   $0.928$    |
|  $50$  |  $1.53066$   |   $0.138$    |
| $100$  |  $0.762366$  |   $0.454$    |
| $200$  |  $1.36317$   |    $0.18$    |
| $500$  | $0.00306572$ |   $0.986$    |
| $1000$ |   $1.9721$   |   $0.038$    |
Результаты проверки гипотезы об __однородности дисперсий__ по критерию __Муда__ выборок: _model_3_, _model_4_.


|  $n$   | Значение $S$ | Значение $P$ |
| :----: | :----------: | :----------: |
|  $25$  | $-0.194786$  |    $0.85$    |
|  $50$  |  $-1.63581$  |   $0.088$    |
| $100$  |  $-1.10051$  |   $0.296$    |
| $200$  |  $-1.91525$  |   $0.044$    |
| $500$  | $-0.256331$  |   $0.784$    |
| $1000$ |  $-2.47562$  |   $0.012$    |
Результаты проверки гипотезы об __однородности дисперсий__ по критерию __Сижеля-Тьюки__ выборок: _model_3_, _model_4_.


|  $n$   | Значение $S$ | Значение $P$ |
| :----: | :----------: | :----------: |
|  $25$  |  $-0.06791$  |   $0.944$    |
|  $50$  |  $1.53043$   |   $0.136$    |
| $100$  |  $0.772111$  |   $0.448$    |
| $200$  |  $1.36056$   |   $0.182$    |
| $500$  | $0.00284673$ |   $0.986$    |
| $1000$ |  $1.97264$   |   $0.038$    |
Из полученные результатов, можно заметить, что __параметрические критерии__ получили близкие результаты $p$-_value_. Возможно это говорит о том, что критерии __Бартлетта__ и __Фишера__ имеют похожую мощность. Также заметно, что у __непараметрических критериев__ __Ансари-Бредли__ и __Сижеля-Тьюки__ получены схожие результаты $p$-_value_, что также говорит о том, что критерии возможно имеют похожую мощность.

Можно заметить, что при данных выборках, параметрические критерии показали более хорошие результаты, чем непараметрические. _Мощность_ __параметрических критериев__ выше, чем у __непараметрических__.

Среди непараметрических критериев, критерий __Муда__ выделяется. Мощность этого критерия выше, чем у критериев __Сижеля-Тьюки__ и __Ансари-Бредли__

Можно сделать вывод, что для того чтобы отклонить __"несправедливую"__ гипотезу при ошибки первого рода $\alpha=0.1$, для параметрических критериев потребуется  $25 < n^* \le 50$ наблюдений, для критерия __Муда__ потребуется $25 < n^* \le 50$ наблюдений, для критериев __Ансари-Бредли__ и __Сижеля-Тьюки__ потребуется $500 < n^* \le 1000$  наблюдений. При ошибки первого рода $\alpha = 0.05$, для параметрических критериев потребуется $25 < n^* \le 50$ наблюдений, для критерия __Муда__ потребуется $100 < n^* \le 200$ наблюдений, для критериев __Ансари-Бредли__ и __Сижеля-Тьюки__ потребуется $500 < n^* \le 1000$ наблюдений. При ошибки первого рода $\alpha = 0.01$, для параметрических критериев потребуется $100 < n^* \le 200$ наблюдений, для непараметрических критериев потребуется $n^* > 1000$ наблюдений.

### Моделирование выборок разного закона

#### Моделирование первой выборки

 Эмпирическая функция распределения _(см. график 9)_ выборки _model_5_, смоделированная в соответствии $N(\sigma = 1, \mu = 0)$ со  с объёмом $n=10000$
 
![[graf65.jpg]]
<div style="text-align: center;">
<em><u>График 9</u></em> Эмпирическая функция распределения выборки <em><u>model_5</u></em>
</div>

Функция плотности распределения _(см. график 10)_ выборки _model_5_, смоделированная в соответствии $N(\sigma = 1, \mu = 0)$ со  с объёмом $n=10000$

![[img65.jpg]]
<div style="text-align: center;">
<em><u>График 10</u></em> Функция плотности распределения выборки <em><u>model_5</u></em>
</div>
#### Моделирование второй выборки

Эмпирическая функция распределения _(см. график 11)_ выборки _model_6_, смоделированная в соответствии $L(s = 0.551328895, \mu = 0)$ со  с объёмом $n=10000$

![[graf66.jpg]]
<div style="text-align: center;">
<em><u>График 11</u></em> Эмпирическая функция распределения выборки <em><u>model_6</u></em>
</div>

Функция плотности распределения _(см. график 12)_ выборки _model_6, смоделированная в соответствии $L(s = 0.551328895, \mu = 0)$ со  с объёмом $n=10000$

![[img66.jpg]]<div style="text-align: center;">
<em><u>График 12</u></em> Функция плотности распределения выборки <em><u>model_6</u></em>
</div>

### Проверка гипотез об однородности законов

Результаты проверки гипотезы об __однородности законов__ по критерию __Смирнова__ выборок: _model_5_, _model_6_.

|   $n$   | Значение $S$ | Значение $P$ |
| :-----: | :----------: | :----------: |
|  $25$   |  $0.848528$  |   $0.464$    |
|  $50$   |    $0.6$     |   $0.864$    |
|  $100$  |  $0.494975$  |   $0.942$    |
|  $200$  |    $0.75$    |   $0.577$    |
|  $500$  |  $0.474342$  |   $0.966$    |
| $1000$  |   $1.2522$   |   $0.082$    |
| $5000$  |    $1.63$    |   $0.016$    |
| $10000$ |  $1.66877$   |   $0.007$    |
Результаты проверки гипотезы об __однородности законов__ по критерию __Лемана-Розенблатта__ выборок: _model_5_, _model_6_.


|   $n$   | Значение $S$ | Значение $P$ |
| :-----: | :----------: | :----------: |
|  $25$   |   $0.1588$   |   $0.379$    |
|  $50$   |   $0.0534$   |   $0.867$    |
|  $100$  |   $0.0554$   |   $0.857$    |
|  $200$  |  $0.106125$  |    $0.56$    |
|  $500$  |  $0.042244$  |   $0.903$    |
| $1000$  |  $0.263003$  |   $0.194$    |
| $5000$  |  $0.77257$   |   $0.016$    |
| $10000$ |  $1.16109$   |     $0$      |

Таким образом, полученные результаты неоднозначны. При $n \le 500$ значения $p$-_value_ критерия __Лемана-Розенблатта__ лучше, но не значительно. При $1000 \le n \le 5000$ ситуация меняется и значения $p$-_value_ критерия __Смирнова__ лучше, но, также, не значительно.

Из полученных результатов, можно заключить предположение, что мощности критериев похожи, поскольку значения $p$-_value_ схожи.

Можно сделать вывод, что для того чтобы отклонить __"несправедливую"__ гипотезу при ошибки первого рода $\alpha=0.1$, для критерия __Смирнова__ потребуется  $500 < n^* \le 1000$ наблюдений, для критерия __Лемана-Розенблатта__ потребуется  $1000 < n^* \le 5000$ . При ошибки первого рода $\alpha = 0.05$, для критериев потребуется  $1000 < n^* \le 5000$ наблюдений. При ошибки первого рода $\alpha = 0.01$, для критериев потребуется  $5000 < n^* \le 10000$ наблюдений.

### Выводы

Из проделанной работы, можно сделать вывод о том, что для проверки __однородности средних__, при __малых__ значениях $n$, разумнее использовать __параметрические критерии__ для проверки гипотез, при достаточно __больших__ $n$ можно использовать, как __непараметрические критерии__, так и __параметрические критерии__ рассмотренные в работе.

Можно сделать вывод, что для проверки __однородности дисперсий__, лучше использовать __параметрические критерии__, поскольку из исследования они имеют _большую мощность_, чем __непараметрические критерии__. Если использовать __непараметрические критерии__, то разумно было бы использовать критерий __Муда__, поскольку среди тех, которые были исследованы в работе, он имеет _большую мощность_.

При проверки гипотез об __однородности законов__, критерии __Смирнова__ и __Лемана-Розенблатта__ показали похожие результаты $p$-_value_ и возможно имеют _схожую мощность_.